<?php

session_start();
include('header.php');
include('connection.php');

error_reporting(0);




?>

<!--
- MAIN
-->

<main>

    <div class='product-container'>

        <div class='container'>

            <!--
- SIDEBAR
-->

            <div class="sidebar  has-scrollbar" data-mobile-menu>

                <div class="sidebar-category">

                    <div class="sidebar-top">
                        <h2 class="sidebar-title">BRAND</h2>



                        <button class="sidebar-close-btn" data-mobile-menu-close-btn>
                            <ion-icon name="close-outline"></ion-icon>
                        </button>
                    </div>

                    <div class="showcase-wrapper">

                        <div class="showcase-container">

                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0CD424777 .jpg"
                                        alt="baby fabric shoes" width="75" height="100" class="showcase-img">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">baby fabric shoes</h4>
                                    </a>

                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$5.00</del>
                                        <p class="price">$4.00</p>

                                    </div>
                                    <div class="price-box">

                                        <p class="price">50% OFF</p>

                                    </div>

                                </div>

                            </div>


                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0B4JLTR93.jpg"
                                        alt="men's hoodies t-shirt" class="showcase-img" width="75" height="90">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">men's hoodies t-shirt</h4>
                                    </a>
                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star-half-outline"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$17.00</del>
                                        <p class="price">$7.00</p>
                                    </div>

                                </div>

                            </div>

                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0C5SXFRTK.jpg" alt="girls t-shirt"
                                        class="showcase-img" width="75" height="90">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">girls t-shirt</h4>
                                    </a>
                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star-half-outline"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$5.00</del>
                                        <p class="price">$3.00</p>
                                    </div>

                                </div>

                            </div>

                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0C4FD3N7R.jpg"
                                        alt="woolen hat for men" class="showcase-img" width="75" height="90">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">woolen hat for men</h4>
                                    </a>
                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$15.00</del>
                                        <p class="price">$12.00</p>
                                    </div>

                                </div>

                            </div>
                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0BN1VNV12.jpg"
                                        alt="woolen hat for men" class="showcase-img" width="75" height="90">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">woolen hat for men</h4>
                                    </a>
                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$15.00</del>
                                        <p class="price">$12.00</p>
                                    </div>

                                </div>

                            </div>


                        </div>

                    </div>

                </div>

                <div class="product-showcase">

                    <h3 class="showcase-heading">best sellers</h3>



                </div>

            </div>



            <div class="sidebar  has-scrollbar" style=" display: none; " data-mobile-menu>

                <div class="sidebar-category">

                    <div class="sidebar-top">
                        <h2 class="sidebar-title">BRAND2</h2>



                        <button class="sidebar-close-btn" data-mobile-menu-close-btn>
                            <ion-icon name="close-outline"></ion-icon>
                        </button>
                    </div>

                    <div class="showcase-wrapper">

                        <div class="showcase-container">

                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0CD424777 .jpg"
                                        alt="baby fabric shoes" width="75" height="100" class="showcase-img">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">baby fabric shoes</h4>
                                    </a>

                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$5.00</del>
                                        <p class="price">$4.00</p>

                                    </div>
                                    <div class="price-box">

                                        <p class="price">50% OFF</p>

                                    </div>

                                </div>

                            </div>


                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0B4JLTR93.jpg"
                                        alt="men's hoodies t-shirt" class="showcase-img" width="75" height="90">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">men's hoodies t-shirt</h4>
                                    </a>
                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star-half-outline"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$17.00</del>
                                        <p class="price">$7.00</p>
                                    </div>

                                </div>

                            </div>

                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0C5SXFRTK.jpg" alt="girls t-shirt"
                                        class="showcase-img" width="75" height="90">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">girls t-shirt</h4>
                                    </a>
                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star-half-outline"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$5.00</del>
                                        <p class="price">$3.00</p>
                                    </div>

                                </div>

                            </div>

                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0C4FD3N7R.jpg"
                                        alt="woolen hat for men" class="showcase-img" width="75" height="90">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">woolen hat for men</h4>
                                    </a>
                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$15.00</del>
                                        <p class="price">$12.00</p>
                                    </div>

                                </div>

                            </div>
                            <div class="showcase">

                                <a href="#" class="showcase-img-box">
                                    <img src="https://rewaaz2images.s3.amazonaws.com/B0BN1VNV12.jpg"
                                        alt="woolen hat for men" class="showcase-img" width="75" height="90">
                                </a>

                                <div class="showcase-content">

                                    <a href="#">
                                        <h4 class="showcase-title">woolen hat for men</h4>
                                    </a>
                                    <div class="showcase-rating">
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                        <ion-icon name="star"></ion-icon>
                                    </div>

                                    <div class="price-box">
                                        <del>$15.00</del>
                                        <p class="price">$12.00</p>
                                    </div>

                                </div>

                            </div>


                        </div>

                    </div>

                </div>

                <div class="product-showcase">

                    <h3 class="showcase-heading">best sellers</h3>



                </div>

            </div>


            <div class="product-box">

                <!--
             - PRODUCT GRID
             -->

                <div class="product-main">



                    <div id="search_products" class="product-grid">


                        <?php


                        $search = $_POST["search_item"];

                        $_SESSION['search_query'] = $search;

                        $limit = 20;
                         
                        $title = 'NA';

                        if (isset($_GET['page'])) {
                            $page = $_GET['page'];
                        } else {
                            $page = 1;

                        }
                        $offset = ($page - 1) * $limit;


                        // OR  title LIKE '%{$search}%'  OR  catg LIKE '%{$search}%' 
                        
                        // 
                        // SQL QUERY 
                        // $query = "SELECT * FROM `products` WHERE title LIKE '%{$search}%' LIMIT $limit  OFFSET $offset ";
                        $query = "SELECT * FROM `products` WHERE title LIKE '%{$search}%' AND title NOT IN ('NA') LIMIT $limit  OFFSET $offset";

                        // FETCHING DATA FROM DATABASE 
                        $result = $conn->query($query);

                        if ($result->num_rows > 0) {
                            // OUTPUT DATA OF EACH ROW 
                            while ($row = $result->fetch_assoc()) {

                                $catg = strtoupper($row["catg"]);

                                // $x = $row["sizes"];
                                // $y = explode("!", $x);
                        

                                ?>

                                <div class="showcase">

                                    <div class="showcase-banner">

                                        <a href="product_page.php?product_id=<?php echo $row["product_id"] ?>"><img
                                                src="https://rewaaz2images.s3.amazonaws.com/<?php echo $row["image"] ?>"
                                                alt="Mens Winter Leathers Jackets" width="300" loading="lazy" id="display_image"
                                                class="product-img default">
                                        </a>

                                        <p class="showcase-badge">-<?php echo $row["discount"]?>%</p>


                                        <div class="showcase-actions">

                                        </div>

                                    </div>
                                </div>

                                <?php
                            }
                        } else {
                            echo "0 results";
                        }



                        ?>


                    </div>







                </div>



                <?php



                $query1 = "SELECT * FROM `products` ";
                $result1 = mysqli_query($conn, $query1) or die("query faild");
                if (mysqli_num_rows($result1) > 0) {

                    $total_records1 = mysqli_num_rows($result1);


                    $total_page = ceil($total_records1 / $limit);

                    $next_page = $page + 1;
                    $preious_page = $page - 1;

                    if ($page == $total_page) {

                        $next_page = $total_page;

                    }

                    if ($page == 1) {

                        $preious_page = 1;

                    }

                    echo '<div class="pagination" align="center">
                    <a href="index.php?page=' . $preious_page . '">&laquo;</a>';
                    for ($i = 1; $i <= $total_page; $i++) {

                        echo '<a href="index.php?page=' . $i . '">' . $i . '</a>';

                    }
                    echo '<a href="index.php?page=' . $next_page . '">&raquo;</a></div>';
                }

                ?>



            </div>

        </div>


</main>





<!--
    - FOOTER
  -->

<?php

include('footer.php');

?>